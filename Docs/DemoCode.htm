<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 * Describes how to use the Clipboard Viewer Component
 *
 * $Rev$
 * $Date$
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

	<title>
		Clipboard Viewer Component Demo Code
	</title>

	<style type="text/css">
		body {
			margin: 1em;
			padding: 0;
			font-family: Verdana, Arial, sans-serif;
			font-size: 9pt;
			line-height: 150%;
		}
		h1 {
			margin: 0 0 1em 0;
			padding: 0.5em;
			border: 1px silver solid;
			background-color: #eee;
			font-size: 13pt;
			font-weight: bold;
			text-align: center;
		}
		h1 .subtitle {
			font-style: italic;
			color: #336;
		}
		h2 {
			margin: 1em 0 0 0;
			padding: 0;
			padding-bottom: 6px;
			border-bottom: 1px silver solid;
			font-size: 11pt;
			font-weight: bold;
		}
		h3 {
			margin: 0.5em 0 0 0;
			padding: 0;
			font-size: 9pt;
			font-weight: bold;
		}
		p {
			margin: 0.5em 0 0 0;
			padding: 0;
		}
		ul, ol {
			margin: 0.5em 0 0 3em;
			padding: 0;
		}
		ul {
			list-style-type: square;
		}
		ul.spaced li,
		ol.spaced li {
			margin-top: 0.5em;
		}
		ul.spaced li,
		ol.spaced li {
			margin-top: 0.5em;
		}
		ul.unspaced li,
		ol.unspaced li {
			margin-top: 0;
		}
		ul.unspaced li.first,
		ol.unspaced li.first {
			margin-top: 0.5em;
		}
		code,
		kbd {
			font-family: "Courier New", Courier, monospace;
		}
		pre.source {
			font-family: "Courier New", Courier, monospace;
			background-color: #ffc;
			border: 1px silver dotted;
			padding: 0.25em;
		}
		a:link {
			color: #336;
			text-decoration: underline;
		}
		a:visited {
			color: #669;
			text-decoration: underline;
		}
		a:active {
			color: #336;
			text-decoration: underline;
		}
		a:hover {
			text-decoration: underline;
		}
		.gototop {
			margin: 1em 0 0 0;
			padding: 0.3em 0 0 0;
			text-align: center;
			position: relative;
			float: right;
			font-weight: bold;
		}
		.pullout {
			border-left: 8px silver solid;
			xborder-bottom: 2px silver solid;
			xborder-top: 2px silver solid;
			background-color: #eee;
			margin: 0.5em 0 0 0;
			padding: 0.25em 0.5em;
			font-style: italic;
		}
		.indent {
			margin-left: 3em;
		}
		.highlight {
			color: #336;
			font-style: italic;
			font-weight: bold;
		}
		.endnotes {
			margin: 1.5em 0 0 0;
			padding: 1em 0 0 0;
			border-top: 1px silver solid;
		}
		.comments {
			font-style: italic;
		}
		.copyright,
		.copyright a:link,
		.copyright a:visited,
		.copyright a:active {
			margin: 1em 0 0 0;
			color: gray;
			font-size: 8pt;
			text-align: right;
		}
	</style>

</head>


<body>

<h1 id="top">
	<div>Clipboard Viewer Componentt</div>
	<div class="subtitle">Demo Code</div>
</h1>

<p>
	The following is an example of how to use the Clipboard Viewer Component.
</p>

<p>
	Drop a <var>TPJCBViewer</var> component, a <var>TButton</var> and a
	<var>TMemo</var> on a form. Do not change any of the components' default
	properties. Add the <code>Clipbrd</code> unit to your uses clause. Using the
	object inspector, create the following event handlers:
</p>

<ul>
	<li>
		an <var>OnClipboardChanged</var> handler for the <var>TPJCBViewer</var>
		component;
	</li>
	<li>
		an <var>OnClick</var> handler for the button.
	</li>
</ul>

<p>
	Implement the event handlers as follows:
</p>

<pre class="source">procedure TForm1.PJCBViewer1ClipboardChanged(Sender: TObject);
begin
  // Clipboard has changed - emit beep and decide whether to enable button
  // (only if text is on clipboard)
  MessageBeep(0);
  Button1.Enabled := ClipBoard.HasFormat(CF_TEXT);
end;

procedure TForm1.Button1Click(Sender: TObject);
begin
  // We assume this button can only be clicked when there is text on clipboard,
  // so it is safe to display the text
  Memo1.Text := ClipBoard.AsText;
end;</pre>

<p>
	Because <var>TPJCBViewer</var>'s <var>TriggerOnCreation</var> property is
	true by default, an <var>OnClipboardChanged</var> event is triggered as the
	program starts. The beep that is generated by the event handler proves this.
</p>

<p>
	The button is enabled only if the clipboard contains text and becomes greyed
	out when the clipboard doesn't contain text. Clicking the button displays
	the clipboard text in the memo. Whenever the clipboard's contents change a
	beep is emitted.
</p>


<div class="endnotes">
	<div class="copyright">
		This document is copyright &copy; 2008-2010, P D Johnson,
		<a
			href="http://www.delphidabbler.com/"
		>www.delphidabbler.com</a>
	</div>
</div>

</body>

</html>
